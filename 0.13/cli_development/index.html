
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://docs.qmk.fm/0.13/cli_development/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>QMK CLI Development - QMK Firmware Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#qmk-cli-development" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="QMK Firmware Docs" class="md-header__button md-logo" aria-label="QMK Firmware Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QMK Firmware Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              QMK CLI Development
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../README.md" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../zh-cn/" hreflang="zh" class="md-select__link">
                    中文
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../es/" hreflang="es" class="md-select__link">
                    Español
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../fr-fr/" hreflang="fr" class="md-select__link">
                    Français
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../he-il/" hreflang="he" class="md-select__link">
                    עברית
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../pt-br/" hreflang="pt" class="md-select__link">
                    Português
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../ru-ru/" hreflang="ru" class="md-select__link">
                    Русский
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../ja/" hreflang="ja" class="md-select__link">
                    日本語
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/qmk/qmk_firmware/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    qmk/qmk_firmware
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Quantum Mechanical Keyboard Firmware
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="QMK Firmware Docs" class="md-nav__button md-logo" aria-label="QMK Firmware Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    QMK Firmware Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/qmk/qmk_firmware/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    qmk/qmk_firmware
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Quantum Mechanical Keyboard Firmware
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/qmk/qmk_firmware/edit/master/docs/cli_development.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="qmk-cli-development">QMK CLI Development<a class="headerlink" href="#qmk-cli-development" title="Permanent link">&para;</a></h1>
<p>This document has useful information for developers wishing to write new <code>qmk</code> subcommands.</p>
<h1 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h1>
<p>The QMK CLI operates using the subcommand pattern made famous by git. The main <code>qmk</code> script is simply there to setup the environment and pick the correct entrypoint to run. Each subcommand is a self-contained module with an entrypoint (decorated by <code>@cli.subcommand()</code>) that performs some action and returns a shell returncode, or None.</p>
<h2 id="developer-mode">Developer mode:<a class="headerlink" href="#developer-mode" title="Permanent link">&para;</a></h2>
<p>If you intend to maintain keyboards and/or contribute to QMK, you can enable the CLI's "Developer" mode:</p>
<p><code>qmk config user.developer=True</code></p>
<p>This will allow you to see all available subcommands.<br />
<strong>Note:</strong> You will have to install additional requirements:  </p>
<div class="codehilite"><pre><span></span><code>python3 -m pip install -r requirements-dev.txt
</code></pre></div>

<h1 id="subcommands">Subcommands<a class="headerlink" href="#subcommands" title="Permanent link">&para;</a></h1>
<p><a href="https://github.com/clueboard/milc">MILC</a> is the CLI framework <code>qmk</code> uses to handle argument parsing, configuration, logging, and many other features. It lets you focus on writing your tool without wasting your time writing glue code.</p>
<p>Subcommands in the local CLI are always found in <code>qmk_firmware/lib/python/qmk/cli</code>.</p>
<p>Let's start by looking at an example subcommand. This is <code>lib/python/qmk/cli/hello.py</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;QMK Python Hello World</span>

<span class="sd">This is an example QMK CLI script.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">milc</span> <span class="kn">import</span> <span class="n">cli</span>


<span class="nd">@cli</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;-n&#39;</span><span class="p">,</span> <span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;World&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name to greet.&#39;</span><span class="p">)</span>
<span class="nd">@cli</span><span class="o">.</span><span class="n">subcommand</span><span class="p">(</span><span class="s1">&#39;QMK Hello World.&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">cli</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Log a friendly greeting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cli</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Hello, </span><span class="si">%s</span><span class="s1">!&#39;</span><span class="p">,</span> <span class="n">cli</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">hello</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

<p>First we import the <code>cli</code> object from <code>milc</code>. This is how we interact with the user and control the script's behavior. We use <code>@cli.argument()</code> to define a command line flag, <code>--name</code>. This also creates a configuration variable named <code>hello.name</code> (and the corresponding <code>user.name</code>) which the user can set so they don't have to specify the argument. The <code>cli.subcommand()</code> decorator designates this function as a subcommand. The name of the subcommand will be taken from the name of the function.</p>
<p>Once inside our function we find a typical "Hello, World!" program. We use <code>cli.log</code> to access the underlying <a href="https://docs.python.org/3.6/library/logging.html#logger-objects">Logger Object</a>, whose behavior is user controllable. We also access the value for name supplied by the user as <code>cli.config.hello.name</code>. The value for <code>cli.config.hello.name</code> will be determined by looking at the <code>--name</code> argument supplied by the user, if not provided it will use the value in the <code>qmk.ini</code> config file, and if neither of those is provided it will fall back to the default supplied in the <code>cli.argument()</code> decorator.</p>
<h1 id="user-interaction">User Interaction<a class="headerlink" href="#user-interaction" title="Permanent link">&para;</a></h1>
<p>MILC and the QMK CLI have several nice tools for interacting with the user. Using these standard tools will allow you to colorize your text for easier interactions, and allow the user to control when and how that information is displayed and stored.</p>
<h2 id="printing-text">Printing Text<a class="headerlink" href="#printing-text" title="Permanent link">&para;</a></h2>
<p>There are two main methods for outputting text in a subcommand- <code>cli.log</code> and <code>cli.echo()</code>. They operate in similar ways but you should prefer to use <code>cli.log.info()</code> for most general purpose printing.</p>
<p>You can use special tokens to colorize your text, to make it easier to understand the output of your program. See <a href="#colorizing-text">Colorizing Text</a> below.</p>
<p>Both of these methods support built-in string formatting using python's <a href="https://docs.python.org/3.6/library/stdtypes.html#old-string-formatting">printf style string format operations</a>. You can use tokens such as <code>%s</code> and <code>%d</code> within your text strings then pass the values as arguments. See our Hello, World program above for an example.</p>
<p>You should never use the format operator (<code>%</code>) directly, always pass values as arguments.</p>
<h3 id="logging-clilog">Logging (<code>cli.log</code>)<a class="headerlink" href="#logging-clilog" title="Permanent link">&para;</a></h3>
<p>The <code>cli.log</code> object gives you access to a <a href="https://docs.python.org/3.6/library/logging.html#logger-objects">Logger Object</a>. We have configured our log output to show the user a nice emoji for each log level (or the log level name if their terminal does not support unicode.) This way the user can tell at a glance which messages are most important when something goes wrong.</p>
<p>The default log level is <code>INFO</code>. If the user runs <code>qmk -v &lt;subcommand&gt;</code> the default log level will be set to <code>DEBUG</code>.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Emoji</th>
</tr>
</thead>
<tbody>
<tr>
<td>cli.log.critical</td>
<td><code>{bg_red}{fg_white}¬_¬{style_reset_all}</code></td>
</tr>
<tr>
<td>cli.log.error</td>
<td><code>{fg_red}☒{style_reset_all}</code></td>
</tr>
<tr>
<td>cli.log.warning</td>
<td><code>{fg_yellow}⚠{style_reset_all}</code></td>
</tr>
<tr>
<td>cli.log.info</td>
<td><code>{fg_blue}Ψ{style_reset_all}</code></td>
</tr>
<tr>
<td>cli.log.debug</td>
<td><code>{fg_cyan}☐{style_reset_all}</code></td>
</tr>
<tr>
<td>cli.log.notset</td>
<td><code>{style_reset_all}¯\\_(o_o)_/¯</code></td>
</tr>
</tbody>
</table>
<h3 id="printing-cliecho">Printing (<code>cli.echo</code>)<a class="headerlink" href="#printing-cliecho" title="Permanent link">&para;</a></h3>
<p>Sometimes you simply need to print text outside of the log system. This is appropriate if you are outputting fixed data or writing out something that should never be logged. Most of the time you should prefer <code>cli.log.info()</code> over <code>cli.echo</code>.</p>
<h3 id="colorizing-text">Colorizing Text<a class="headerlink" href="#colorizing-text" title="Permanent link">&para;</a></h3>
<p>You can colorize the output of your text by including color tokens within text. Use color to highlight, not to convey information. Remember that the user can disable color, and your subcommand should still be usable if they do.</p>
<p>You should generally avoid setting the background color, unless it's integral to what you are doing. Remember that users have a lot of preferences when it comes to their terminal color, so you should pick colors that work well against both black and white backgrounds.</p>
<p>Colors prefixed with 'fg' will affect the foreground (text) color. Colors prefixed with 'bg' will affect the background color.</p>
<table>
<thead>
<tr>
<th>Color</th>
<th>Background</th>
<th>Extended Background</th>
<th>Foreground</th>
<th>Extended Foreground</th>
</tr>
</thead>
<tbody>
<tr>
<td>Black</td>
<td>{bg_black}</td>
<td>{bg_lightblack_ex}</td>
<td>{fg_black}</td>
<td>{fg_lightblack_ex}</td>
</tr>
<tr>
<td>Blue</td>
<td>{bg_blue}</td>
<td>{bg_lightblue_ex}</td>
<td>{fg_blue}</td>
<td>{fg_lightblue_ex}</td>
</tr>
<tr>
<td>Cyan</td>
<td>{bg_cyan}</td>
<td>{bg_lightcyan_ex}</td>
<td>{fg_cyan}</td>
<td>{fg_lightcyan_ex}</td>
</tr>
<tr>
<td>Green</td>
<td>{bg_green}</td>
<td>{bg_lightgreen_ex}</td>
<td>{fg_green}</td>
<td>{fg_lightgreen_ex}</td>
</tr>
<tr>
<td>Magenta</td>
<td>{bg_magenta}</td>
<td>{bg_lightmagenta_ex}</td>
<td>{fg_magenta}</td>
<td>{fg_lightmagenta_ex}</td>
</tr>
<tr>
<td>Red</td>
<td>{bg_red}</td>
<td>{bg_lightred_ex}</td>
<td>{fg_red}</td>
<td>{fg_lightred_ex}</td>
</tr>
<tr>
<td>White</td>
<td>{bg_white}</td>
<td>{bg_lightwhite_ex}</td>
<td>{fg_white}</td>
<td>{fg_lightwhite_ex}</td>
</tr>
<tr>
<td>Yellow</td>
<td>{bg_yellow}</td>
<td>{bg_lightyellow_ex}</td>
<td>{fg_yellow}</td>
<td>{fg_lightyellow_ex}</td>
</tr>
</tbody>
</table>
<p>There are also control sequences that can be used to change the behavior of
ANSI output:</p>
<table>
<thead>
<tr>
<th>Control Sequences</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>{style_bright}</td>
<td>Make the text brighter</td>
</tr>
<tr>
<td>{style_dim}</td>
<td>Make the text dimmer</td>
</tr>
<tr>
<td>{style_normal}</td>
<td>Make the text normal (neither <code>{style_bright}</code> nor <code>{style_dim}</code>)</td>
</tr>
<tr>
<td>{style_reset_all}</td>
<td>Reset all text attributes to default. (This is automatically added to the end of every string.)</td>
</tr>
<tr>
<td>{bg_reset}</td>
<td>Reset the background color to the user's default</td>
</tr>
<tr>
<td>{fg_reset}</td>
<td>Reset the foreground color to the user's default</td>
</tr>
</tbody>
</table>
<h1 id="arguments-and-configuration">Arguments and Configuration<a class="headerlink" href="#arguments-and-configuration" title="Permanent link">&para;</a></h1>
<p>QMK handles the details of argument parsing and configuration for you. When you add a new argument it is automatically incorporated into the config tree based on your subcommand's name and the long name of the argument. You can access this configuration in <code>cli.config</code>, using either attribute-style access (<code>cli.config.&lt;subcommand&gt;.&lt;argument&gt;</code>) or dictionary-style access (<code>cli.config['&lt;subcommand&gt;']['&lt;argument&gt;']</code>).</p>
<p>Under the hood QMK uses <a href="https://docs.python.org/3/library/configparser.html">ConfigParser</a> to store configurations. This gives us an easy and straightforward way to represent the configuration in a human-editable way. We have wrapped access to this configuration to provide some nicities that ConfigParser does not normally have.</p>
<h2 id="reading-configuration-values">Reading Configuration Values<a class="headerlink" href="#reading-configuration-values" title="Permanent link">&para;</a></h2>
<p>You can interact with <code>cli.config</code> in all the ways you'd normally expect. For example the <code>qmk compile</code> command gets the keyboard name from <code>cli.config.compile.keyboard</code>. It does not need to know whether that value came from the command line, an environment variable, or the configuration file.</p>
<p>Iteration is also supported:</p>
<div class="codehilite"><pre><span></span><code>for section in cli.config:
    for key in cli.config[section]:
        cli.log.info(&#39;%s.%s: %s&#39;, section, key, cli.config[section][key])
</code></pre></div>

<h2 id="setting-configuration-values">Setting Configuration Values<a class="headerlink" href="#setting-configuration-values" title="Permanent link">&para;</a></h2>
<p>You can set configuration values in the usual ways.</p>
<p>Dictionary style:</p>
<div class="codehilite"><pre><span></span><code>cli.config[&#39;&lt;section&gt;&#39;][&#39;&lt;key&gt;&#39;] = &lt;value&gt;
</code></pre></div>

<p>Attribute style:</p>
<div class="codehilite"><pre><span></span><code>cli.config.&lt;section&gt;.&lt;key&gt; = &lt;value&gt;
</code></pre></div>

<h2 id="deleting-configuration-values">Deleting Configuration Values<a class="headerlink" href="#deleting-configuration-values" title="Permanent link">&para;</a></h2>
<p>You can delete configuration values in the usual ways.</p>
<p>Dictionary style:</p>
<div class="codehilite"><pre><span></span><code>del(cli.config[&#39;&lt;section&gt;&#39;][&#39;&lt;key&gt;&#39;])
</code></pre></div>

<p>Attribute style:</p>
<div class="codehilite"><pre><span></span><code>del(cli.config.&lt;section&gt;.&lt;key&gt;)
</code></pre></div>

<h2 id="writing-the-configuration-file">Writing The Configuration File<a class="headerlink" href="#writing-the-configuration-file" title="Permanent link">&para;</a></h2>
<p>The configuration is not written out when it is changed. Most commands do not need to do this. We prefer to have the user change their configuration deliberitely using <code>qmk config</code>.</p>
<p>You can use <code>cli.save_config()</code> to write out the configuration.</p>
<h2 id="excluding-arguments-from-configuration">Excluding Arguments From Configuration<a class="headerlink" href="#excluding-arguments-from-configuration" title="Permanent link">&para;</a></h2>
<p>Some arguments should not be propagated to the configuration file. These can be excluded by adding <code>arg_only=True</code> when creating the argument.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code>@cli.argument(&#39;-o&#39;, &#39;--output&#39;, arg_only=True, help=&#39;File to write to&#39;)
@cli.argument(&#39;filename&#39;, arg_only=True, help=&#39;Configurator JSON file&#39;)
@cli.subcommand(&#39;Create a keymap.c from a QMK Configurator export.&#39;)
def json_keymap(cli):
    pass
</code></pre></div>

<p>You will only be able to access these arguments using <code>cli.args</code>. For example:</p>
<div class="codehilite"><pre><span></span><code>cli.log.info(&#39;Reading from %s and writing to %s&#39;, cli.args.filename, cli.args.output)
</code></pre></div>

<h1 id="testing-and-linting-and-formatting-oh-my">Testing, and Linting, and Formatting (oh my!)<a class="headerlink" href="#testing-and-linting-and-formatting-oh-my" title="Permanent link">&para;</a></h1>
<p>We use nose2, flake8, and yapf to test, lint, and format code. You can use the <code>pytest</code> and <code>pyformat</code> subcommands to run these tests:</p>
<h3 id="testing-and-linting">Testing and Linting<a class="headerlink" href="#testing-and-linting" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code>qmk pytest
</code></pre></div>

<h3 id="formatting">Formatting<a class="headerlink" href="#formatting" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code>qmk pyformat
</code></pre></div>

<h2 id="formatting-details">Formatting Details<a class="headerlink" href="#formatting-details" title="Permanent link">&para;</a></h2>
<p>We use <a href="https://github.com/google/yapf">yapf</a> to automatically format code. Our configuration is in the <code>[yapf]</code> section of <code>setup.cfg</code>.</p>
<p>?&gt; Tip- Many editors can use yapf as a plugin to automatically format code as you type.</p>
<h2 id="testing-details">Testing Details<a class="headerlink" href="#testing-details" title="Permanent link">&para;</a></h2>
<p>Our tests can be found in <code>lib/python/qmk/tests/</code>. You will find both unit and integration tests in this directory. We hope you will write both unit and integration tests for your code, but if you do not please favor integration tests. </p>
<p>If your PR does not include a comprehensive set of tests please add comments like this to your code so that other people know where they can help:</p>
<div class="codehilite"><pre><span></span><code># TODO(unassigned/&lt;your_github_username&gt;): Write &lt;unit|integration&gt; tests
</code></pre></div>

<p>We use <a href="https://nose2.readthedocs.io/en/latest/getting_started.html">nose2</a> to run our tests. You can refer to the nose2 documentation for more details on what you can do in your test functions.</p>
<h2 id="linting-details">Linting Details<a class="headerlink" href="#linting-details" title="Permanent link">&para;</a></h2>
<p>We use flake8 to lint our code. Your code should pass flake8 before you open a PR. This will be checked when you run <code>qmk pytest</code> and by CI when you submit a PR.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.febc23d1.min.js"></script>
      
    
  </body>
</html>